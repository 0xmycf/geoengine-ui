<wave-sidenav-header>GBIF & IUCN Loader</wave-sidenav-header>
<form [formGroup]="form" (ngSubmit)="$event.preventDefault();add($event)">
        <div>
            <wave-dialog-section-heading
                title="1. Search Species"
                subtitle="Lookup a Scientific Name"
            ></wave-dialog-section-heading>
            <div fxLayout="row">
                <md-input-container fxFlex>
                    <input mdInput
                           placeholder="Scientific Name"
                           [mdAutocomplete]="auto"
                           formControlName="searchString"
                    >
                </md-input-container>
                <md-autocomplete #auto="mdAutocomplete">
                    <md-option *ngFor="let result of autoCompleteResults$ | async" [value]="result">
                        {{result}}
                    </md-option>
                </md-autocomplete>
            </div>
            <div fxLayout="row">
                <button md-raised-button
                        fxFlex
                        *ngIf="(mode$ | async) === 1"
                        color="accent"
                        (click)="lookup()"
                        [disabled]="(form.controls.searchString.valueChanges | async)?.length < minSearchLength"
                >
                    Lookup
                </button>
                <button md-raised-button
                        fxFlex
                        *ngIf="(mode$ | async) === 2"
                        color="accent"
                        (click)="reset()"
                >
                    Reset
                </button>
            </div>
        </div>
        <div *ngIf="(mode$ | async) === 2">
            <wave-dialog-section-heading
                title="2. Select Resources"
                subtitle="Select different source results"
            ></wave-dialog-section-heading>
            <md-progress-circle mode="indeterminate" *ngIf="loading$ | async"></md-progress-circle>
            <div fxLayout="column" *ngIf="!(loading$ | async)" formGroupName="select">
                <md-checkbox *ngIf="gbifCount > 0" formControlName="gbif" fxFlex>
                    GBIF ({{gbifCount}})
                </md-checkbox>
                <md-checkbox *ngIf="iucnCount > 0" formControlName="iucn" fxFlex>
                    IUCN ({{iucnCount}})
                </md-checkbox>
                <p *ngIf="gbifCount <= 0 && iucnCount <= 0" fxFlex>No Lookup Results</p>
            </div>
        </div>
        <wave-operator-output-name
            formControlName="name"
            [suggestion]="form.controls.searchString.valueChanges | async"
        ></wave-operator-output-name>
        <div fxLayout="row">
            <button
                type="submit"
                md-raised-button
                fxFlex
                color="primary"
                [disabled]="(form.statusChanges | async) !== 'VALID'"
            >
                Add
            </button>
        </div>
</form>
