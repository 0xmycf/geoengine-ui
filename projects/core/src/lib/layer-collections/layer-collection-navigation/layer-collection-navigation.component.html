<geoengine-sidenav-header>{{ rootCollectionItem.name }}</geoengine-sidenav-header>

@if (search.isSearching) {
    <mat-form-field class="search" appearance="outline" subscriptSizing="dynamic">
        <mat-icon matPrefix>search</mat-icon>
        <input
            matInput
            #searchInput
            type="text"
            placeholder="Search in collection"
            [ngModel]="search.searchString.value"
            (ngModelChange)="search.searchString.next($event)"
            [matAutocomplete]="searchAutocomplete"
        />
    </mat-form-field>
    <mat-autocomplete #searchAutocomplete="matAutocomplete">
        @for (option of search.autocompleteResults | async; track option) {
            <mat-option [value]="option">{{ option }}</mat-option>
        }
    </mat-autocomplete>

    <button mat-button class="search-settings-btn small-btn" matTooltip="Search Settings" matTooltipPosition="before">
        <mat-icon>tune</mat-icon>
    </button>
} @else {
    <button
        mat-button
        class="back-btn small-btn"
        (click)="breadcrumbs.back()"
        matTooltip="Navigate Back"
        matTooltipPosition="before"
        [disabled]="breadcrumbs.isBackDisabled"
    >
        <mat-icon>arrow_back</mat-icon>
    </button>

    <button
        mat-button
        class="forth-btn small-btn"
        (click)="breadcrumbs.forward()"
        matTooltip="Navigate Forward"
        matTooltipPosition="before"
        [disabled]="breadcrumbs.isForwardDisabled"
    >
        <mat-icon>arrow_forward</mat-icon>
    </button>

    <div #scrollElement class="breadcrumbs">
        <button mat-stroked-button (click)="breadcrumbs.navigateToRoot()" class="root-btn small-btn"><mat-icon>layers</mat-icon></button>
        @for (item of breadcrumbs.activeTrail; track $index) {
            <mat-icon>chevron_right</mat-icon>
            <button mat-stroked-button class="breadcrumb" (click)="breadcrumbs.onBreadCrumbClick($index)">
                @if (item.type === 'collection') {
                    {{ layerCollectionItem(item).name }}
                } @else {
                    "{{ layerCollectionSearch(item).searchString }}"
                }
            </button>
        }
    </div>
}

@if (search.hasSearchCapabilities) {
    <button mat-button class="search-btn small-btn" matTooltip="Search" matTooltipPosition="before" (click)="search.toggleSearch()">
        <mat-icon>search</mat-icon>
    </button>
}

@if (selectedCollection && selectedCollection.type === 'collection') {
    <geoengine-layer-collection-list
        class="portal-outlet"
        (selectCollection)="breadcrumbs.selectCollection($event)"
        [collection]="layerCollectionItem(selectedCollection).id"
    ></geoengine-layer-collection-list>
} @else if (selectedCollection && selectedCollection.type === 'search') {
    <geoengine-layer-collection-list
        class="portal-outlet"
        (selectCollection)="breadcrumbs.selectCollection($event)"
        [collection]="layerCollectionSearch(selectedCollection)"
    ></geoengine-layer-collection-list>
}
