<geoengine-sidenav-header>Rasterization</geoengine-sidenav-header>

<geoengine-dialog-help>
    <p>
        TODO This operator filters the given point layer using the given polygon layer. The resulting layer contains only (multi) points
        that are contained by at least one polygon spatially and temporally.
    </p>
</geoengine-dialog-help>

<form [formGroup]="form" (ngSubmit)="$event.preventDefault(); add()">
    <div class="container">
        <geoengine-layer-selection [types]="inputTypes" formControlName="layer"></geoengine-layer-selection>
        <geoengine-dialog-section-heading title="Config" subtitle="Specify the rasterization parameters">
        </geoengine-dialog-section-heading>
        <div formGroupName="rasterization">
            <!-- <mat-form-field appearance="fill">
                <mat-label>Grid or density</mat-label>
                <mat-select formControlName="gridOrDensity">
                    <mat-option value="grid">Grid</mat-option>
                    <mat-option value="density">Density</mat-option>
                </mat-select>
            </mat-form-field> -->
            <mat-tab-group
                color="primary"
                disablePagination
                [selectedIndex]="selected.value"
                (selectedIndexChange)="selected.setValue($event)"
            >
                <mat-tab label="Grid">
                    <ng-container *ngTemplateOutlet="gridTemplate"></ng-container>
                </mat-tab>
                <mat-tab label="Density">
                    <ng-container *ngTemplateOutlet="densityTemplate"></ng-container>
                </mat-tab>
            </mat-tab-group>

            <!-- <ng-container *ngIf="form.controls.rasterization.value.gridOrDensity === 'grid'"> -->
            <!-- <mat-form-field appearance="fill"> -->
            <ng-template #gridTemplate>
                <!-- <ng-container *ngIf="form.controls.rasterization.controls.gridOrDensity.value === 0"> -->
                <label id="radio-group-label" class="labelRadioGroup">Size mode:</label>
                <mat-radio-group color="primary" formControlName="gridSizeMode" aria-labelledby="radio-group-label">
                    <mat-radio-button value="fixed">Fixed</mat-radio-button>
                    <mat-radio-button value="relative">Relative</mat-radio-button>
                </mat-radio-group>
                <div formGroupName="resolution" class="groupInRow">
                    <mat-form-field appearance="fill">
                        <mat-label>Resolution (x)</mat-label>
                        <input matInput type="number" formControlName="resX" />
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Resolution (y)</mat-label>
                        <input matInput type="number" formControlName="resY" />
                    </mat-form-field>
                </div>
                <div formGroupName="origin" class="groupInRow">
                    <mat-form-field appearance="fill">
                        <mat-label>Origin (x)</mat-label>
                        <input matInput type="number" formControlName="originX" />
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Origin (y)</mat-label>
                        <input matInput type="number" formControlName="originY" />
                    </mat-form-field>
                </div>
            </ng-template>
            <ng-template #densityTemplate>
                <!-- <ng-container *ngIf="form.controls.rasterization.value.gridOrDensity === 'density'"> -->
                <div class="groupInRow" *ngIf="selected.value === 1">
                    <mat-form-field appearance="fill">
                        <mat-label>Radius</mat-label>
                        <input matInput type="number" formControlName="radius" />
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Stddev</mat-label>
                        <input matInput type="number" formControlName="stddev" />
                    </mat-form-field>
                </div>
                <!-- </ng-container> -->
            </ng-template>
        </div>
        <geoengine-operator-output-name formControlName="name">
            <mat-hint align="end" class="error" *ngIf="form.controls.name.errors?.required || form.controls.name.errors?.onlyWhitespace">
                The name must be non-empty.
            </mat-hint>
        </geoengine-operator-output-name>
    </div>
    <div class="actions">
        <button type="submit" mat-raised-button color="primary" [disabled]="form.invalid">Create</button>
    </div>
</form>
