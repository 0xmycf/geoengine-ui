<geoengine-sidenav-header>Rasterization</geoengine-sidenav-header>

<geoengine-dialog-help>
    <p>
        TODO This operator filters the given point layer using the given polygon layer. The resulting layer contains only (multi) points
        that are contained by at least one polygon spatially and temporally.
    </p>
</geoengine-dialog-help>

<form [formGroup]="form" (ngSubmit)="$event.preventDefault(); add()">
    <div class="container">
        <geoengine-layer-selection [types]="inputTypes" formControlName="layer"></geoengine-layer-selection>
        <geoengine-dialog-section-heading title="Config" subtitle="Specify the rasterization parameters">
        </geoengine-dialog-section-heading>
        <div formGroupName="rasterization">
            <mat-form-field appearance="fill">
                <mat-label>Grid or density</mat-label>
                <mat-select formControlName="gridOrDensity">
                    <mat-option value="grid">Grid</mat-option>
                    <mat-option value="density">Density</mat-option>
                </mat-select>
                <!-- <label>Grid or density</label>
                <mat-radio-group formControlName="gridOrDensity">
                    <mat-radio-button value="grid">Grid</mat-radio-button>
                    <mat-radio-button value="density">Density</mat-radio-button>
                </mat-radio-group> -->
            </mat-form-field>
            <ng-container *ngIf="form.controls.rasterization.value.gridOrDensity === 'grid'">
                <mat-form-field appearance="fill">
                    <mat-label>Size mode fixed/relative</mat-label>
                    <mat-select formControlName="gridSizeMode">
                        <mat-option value="fixed">Fixed</mat-option>
                        <mat-option value="relative">Relative</mat-option>
                    </mat-select>
                    <mat-hint *ngIf="form.controls.rasterization.value.gridSizeMode === 'fixed'"> Cell size in coordinate units</mat-hint>
                    <mat-hint *ngIf="form.controls.rasterization.value.gridSizeMode === 'relative'"> Cell size in pixels </mat-hint>
                </mat-form-field>
                <div formGroupName="resolution" class="groupInRow">
                    <mat-form-field appearance="fill">
                        <mat-label>Resolution (x)</mat-label>
                        <input matInput type="number" formControlName="resX" />
                        <!-- <mat-hint class="error" *ngIf="form.controls.rasterization.value.resolution.errors?.noFilter">
                                Please specify the value.
                            </mat-hint> -->
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Resolution (y)</mat-label>
                        <input matInput type="number" formControlName="resY" />
                        <!-- <mat-hint
                            class="error"
                            *ngIf="
                                form.controls.rasterization.value.resY.errors?.noFilter ||
                                form.controls.rasterization.value.resY.errors?.noFiniteNumber
                            "
                        >
                            Please specify the value.
                        </mat-hint> -->
                    </mat-form-field>
                </div>
                <div formGroupName="origin" class="groupInRow">
                    <mat-form-field appearance="fill">
                        <mat-label>Origin (x)</mat-label>
                        <input matInput type="number" formControlName="originX" />
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Origin (y)</mat-label>
                        <input matInput type="number" formControlName="originY" />
                    </mat-form-field>
                </div>
            </ng-container>
            <ng-container *ngIf="form.controls.rasterization.value.gridOrDensity === 'density'">
                <div class="groupInRow">
                    <mat-form-field appearance="fill">
                        <mat-label>Radius</mat-label>
                        <input matInput type="number" formControlName="radius" />
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>Stddev</mat-label>
                        <input matInput type="number" formControlName="stddev" />
                    </mat-form-field>
                </div>
            </ng-container>
        </div>
        <geoengine-operator-output-name formControlName="name">
            <mat-hint align="end" class="error" *ngIf="form.controls.name.errors?.required || form.controls.name.errors?.onlyWhitespace">
                The name must be non-empty.
            </mat-hint>
        </geoengine-operator-output-name>
    </div>
    <div class="actions">
        <button type="submit" mat-raised-button color="primary" [disabled]="form.invalid">Create</button>
    </div>
</form>
